<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minha √Årvore de Compet√™ncias Interativa</title>
    <link rel="icon" href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üöÄ</text></svg>" type="image/svg+xml">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #4f4f4f;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            overflow: auto;
            font-family: 'Roboto Light', 'Roboto', sans-serif; /* Tente 'Roboto Light' primeiro, depois 'Roboto', e depois qualquer sans-serif */
            color: #333;
        }

        object {
            width: 100%;
            height: auto;
            max-width: 100%;
            max-height: 1200px;
            display: block;
            margin: 0 auto;
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow-y: auto;
            overflow-x: hidden;           
            padding: 20px;
            box-sizing: border-box;
        }
       
        @media (max-width: 768px) {
            object {
                width: auto;
                height: 95vh;
            }
            body {
                align-items: flex-start;
                padding: 10px 0;
            }
        }
    </style>
</head>
<body>
    <object id="mySvgObject" data="arvore_projetos.svg" type="image/svg+xml"></object>
    <script>        
        //path_M110056547603V559239H108647V547603H110056ZM1140455 ingles        
        //path_M11306414149H112923C112915141449112914141411287914 ci/cd
        //path_M112268152466V153629H112127V152466H112268ZM1126671 infra iac
        //path_M113064162168H112923C11291516212711291620921128791 Cloud compu
        //path_M112764171433C112757171376112729171331112681171299 SRE                        
        
    const hookfigma ={
        hook0 : "path_00000000000000000000000000000000000000000000000000", //vazio
        hook1 : "path_M158097334742H15795L158377323105H158522L1589533474", //DadosIA --> analise de dados 
        hook2 : "path_M15805531005H158218L158613540664H158627L1590225310", //DadosIA --> machine elairne 
        hook3 : "path_M158097702999H15795L158377691363H158522L1589570299", //DadosIA --> automa√ß√£o
        hook4 : "path_M167161943381V955017H16702V943381H167161ZM16755994", //IoT     --> internet das coisas
        hook5 : "path_M16702113511V112347H167161V112865H167781V112347H16", //IoT     --> Hardware e eletronica
        hook6 : "path_M153024141478H152883C15287514143715286141402152841", //DevOps  --> containers
        hook7 : "path_M600312172618V171454H60438C60519117145460585917146", //Dev     --> backend
        hook8 : "path_M600312155061V153898H607289V154023H601721V154416H6", //Dev     --> frontend
        hook9 : "path_M352025100132H337253L37998989681H394525L4372531001", //Fund     --> arquitetura de software        
        hook10 : "path_M347253865872V854235H361343V864622H415434V865872H3", //Fund    -->linguagens
        hook11 : "path_M203205154498V153334H207273C2080841533342087521533", //Dev    -->Banco de dados
        hook12 : "path_M347253112517V111354H361343V112392H415434V112517H3", //Fund   -->logica e extrutura de dados
        hook13 : "path_M11501664591C11494266401511466666356811418166325C1", //Skils   -->skils
        hook14 : "path_M203205165334H204887L2088411663H208978L21293216533", //Monol√≠to   -->Monol√≠to
        hook15 : "path_M345577370333V358696H352555V359946H346986V363878H3",// Seguranca --> fund
        hook16 : "path_M203205177134H204887L2088411781H208978L21293217713" // Dev -->    Mobile
    };
    const github = "https://github.com/fabiuniz";
    const linksDataFigma = [
        { hook: "DadosIA", path: hookfigma.hook1, label: "An√°lise Turnover (Python, ML)", url: github+"/turnover" ,description: "Previs√£o de Turnover de Funcion√°rios com FastAPI e TensorFlow", nmmd:"path_readme"},
        { hook: "DadosIA", path: hookfigma.hook1, label: "Dashboard Empresarial - Projeto Power BI", url: github+"/py_powerbi" ,description: " Dashboard Geral da Empresa utilizando Python, Dash e Plotly, com integra√ß√£o via Docker", nmmd:"path_readme" }, 
        { hook: "DadosIA", path: hookfigma.hook2, label: "An√°lise Turnover (ML, Previs√£o)", url: github+"/turnover" ,description: "Previs√£o de Turnover de Funcion√°rios com FastAPI e TensorFlow", nmmd:"path_readme"},
        { hook: "DadosIA", path: hookfigma.hook2, label: "Ferramenta IA p/ V√≠deos (Whisper, Gemini API)", url: github+"/yt-transcribe-ai" ,description: "Projeto para transcrever v√≠deos do YouTube e realizar an√°lise de sentimento usando FastAPI e IA.", nmmd:"path_readme"},
        { hook: "DadosIA", path: hookfigma.hook3, label: "Ferramenta IA p/ V√≠deos (Fluxos Automatizados)", url: github+"/yt-transcribe-ai" ,description: "Projeto para transcrever v√≠deos do YouTube e realizar an√°lise de sentimento usando FastAPI e IA.", nmmd:"path_readme"},
        { hook: "IoT", path: hookfigma.hook4, label: "MIDI Controller (USB)", url: github+"/Midi_Arduino" ,description: "Projeto de um controlador MIDI baseado em Arduino.", nmmd:"path_readme"},
        { hook: "IoT", path: hookfigma.hook5, label: "MIDI Controller (USB)", url: github+"/Midi_Arduino" ,description: "Projeto de um controlador MIDI baseado em Arduino.", nmmd:"path_readme"},
        { hook: "DevOps", path: hookfigma.hook6, label: "Amb. Dev Docker Gen√©rico", url: github+"/script_docker" ,description: "Configura√ß√£o de ambiente de desenvolvimento utilizando Docker Compose.", nmmd:"path_readme"},
        { hook: "Dev", path: hookfigma.hook7, label: "PostgreSQL, JPA (em projetos Java)", url: github+"/dslist-rest" ,description: "Projeto Java Spring", nmmd:"path_readme"},
        { hook: "Dev", path: hookfigma.hook8, label: "Jogo JS (JavaScript)", url: github+"/game_javascript" ,description: "Projeto de jogo baseado em JavaScript.", nmmd:"path_readme"},
        { hook: "Dev", path: hookfigma.hook11, label: "PostgreSQL, JPA (em projetos Java)", url: github+"/dslist-rest" ,description: "Projeto Java Spring", nmmd:"path_readme"},        
        { hook: "Fund", path: hookfigma.hook9, label: "APIs e Integra√ß√µes (dslist-rest)", url: github+"/dslist-rest" ,description: "Projeto Java Spring", nmmd:"path_readme"},
        { hook: "Fund", path: hookfigma.hook10, label: "Flutter Mobile", url: github+"/apptast" ,description: "TechTaste - Aplicativo de Restaurantes", nmmd:"path_readme"},
        { hook: "Fund", path: hookfigma.hook10, label: "Java (dslist-rest)", url: github+"/dslist-rest" ,description: "Projeto Java Spring", nmmd:"path_readme"},
        { hook: "Fund", path:hookfigma.hook10, label: "Python (Amb. Dev Docker)", url: github+"/script_docker" ,description: "Extrutura base para aplica√ß√£o python", nmmd:"path_readme"},
        { hook: "Fund", path:hookfigma.hook12, label: "Reengenharia de Fun√ß√µes", url: github+"/appdla" ,description: "Desafio 21 Dias de C√≥digo Fonte TV", nmmd:"path_readme"},
        { hook: "Fund", path:hookfigma.hook12, label: "Gerenciamento de Estudos", url: github+"/StudyFlow" ,description: "Seu Assistente de Estudos Tecnol√≥gicos", nmmd:"path_readme"},
        { hook: "Skils", path: hookfigma.hook13, label: "PHP (Portf√≥lio Geral)", url: "https://github.com/fabiuniz" ,description: "Portifolio", nmmd:"path_readme"},
    ];  
    function assignIdsAndLinksToSvgElements() {
        const svgObject = document.getElementById('mySvgObject');
        svgObject.addEventListener('load', function() {
            const svgDoc = svgObject.contentDocument;
            if (!svgDoc) {
                console.error("N√£o foi poss√≠vel acessar o conte√∫do do SVG. Certifique-se de que o SVG est√° no mesmo dom√≠nio (Same-Origin Policy).");
                return;
            }                
            const style = svgDoc.createElementNS("http://www.w3.org/2000/svg", "style");
            style.textContent = `
                .interactive-node {
                    cursor: pointer;
                    /*transition: fill 0.3s ease-in-out, stroke 0.3s ease-in-out, stroke-width 0.3s ease-in-out;*/
                    /*fill: #0903f182;*/
                    /*stroke: #0903f182*/;
                }
                .clickable-overlay {
                    cursor: pointer;    
                }                    
                .interactive-node-hover, .interactive-node:hover {
                    /*fill: #FFA500;*/
                    /*stroke: #FF8C00;*/
                    /*stroke-width: 2.5px;*/
                }
                
                text {
                    user-select: none;
                    pointer-events: none;
                    /*font-size: 20px;    */
                    /*fill: #333; */
                }
                .link-span {
                    cursor: pointer;
                    display: block; /* Garante que o span ocupe toda a largura dispon√≠vel */
                    /*text-align: center;*/
                    /*margin-top: 5px; /* Espa√ßamento entre o SVG e o link */
                    font-size: 14px;
                    color: black;
                    font-family: 'Roboto Light', 'Roboto', sans-serif; 
                    text-decoration: underline;
                    white-space: nowrap;
                }
                .link-span:hover {
                    color: yellow;
                }
            `;
            const svgRoot = svgDoc.documentElement;
            if (svgRoot) {
                svgRoot.insertBefore(style, svgRoot.firstChild);
            }
            const potentialNodes = Array.from(svgDoc.querySelectorAll('path'));
            const interactiveNodes = [];
            potentialNodes.forEach(element => {
                const fill = element.getAttribute('fill');                    
                //if (fill === 'white' || fill === '#DBDBDB') {
                if (fill === 'white') {
                    interactiveNodes.push(element);
                }
            });
            let idCounter = 0;
            interactiveNodes.forEach((currentSvgElement) => {
                let generatedId = currentSvgElement.id;
                if (!generatedId) {
                    if (currentSvgElement.tagName === 'path') {
                        const dAttribute = currentSvgElement.getAttribute('d');                         
                        generatedId = `path_${dAttribute.replace(/[^a-zA-Z0-9_]/g, '').substring(0, 50)}`;
                    } else if (currentSvgElement.tagName === 'ellipse' || currentSvgElement.tagName === 'circle') {
                        const cx = currentSvgElement.getAttribute('cx');
                        const cy = currentSvgElement.getAttribute('cy');
                        const safeCx = cx ? cx.replace('.', '_') : '0';
                        const safeCy = cy ? cy.replace('.', '_') : '0';
                        generatedId = `${currentSvgElement.tagName}_${safeCx}_${safeCy}`;
                    }
                    let tempId = generatedId;
                    let uniqueAttempt = 0;
                    while(svgDoc.getElementById(tempId) && svgDoc.getElementById(tempId) !== currentSvgElement) {
                        tempId = `${generatedId}_${uniqueAttempt++}`;
                    }
                    generatedId = tempId;
                    /*console.log(`Generated ID: ${generatedId}`);*/
                    
                    currentSvgElement.id = generatedId;
                }
                idCounter++;
            });
            addSpanbellow(svgDoc, linksDataFigma); // Changed to pass svgDoc and linksDataFigma
            /*console.log(`\n--- Resumo de Atribui√ß√£o de Links ---`);*/
            /*console.log(`Total de elementos interativos ("n√≥s") encontrados no SVG: ${interactiveNodes.length}`);*/
            /*console.log(`Total de links no linksDataFigma: ${linksDataFigma.length}`);*/
        });

    }

    
    function addSpanbellow(svgDoc, linksToAssign) {
        // Objeto para armazenar o deslocamento vertical para cada elemento SVG,
        // garantindo que links subsequentes para o mesmo elemento fiquem abaixo.
        const verticalOffsetMap = new Map();
        const horizontalOffsetMap = new Map(); // Para controlar o offset horizontal se houver v√°rios links

        linksToAssign.forEach(link => {
            const targetElement = svgDoc.getElementById(link.path);
            if (targetElement) {
                const bbox = targetElement.getBBox();

                // Obtenha o deslocamento vertical atual para este elemento
                let currentVerticalOffset = verticalOffsetMap.get(targetElement.id) || 0;
                let currentHorizontalOffset = horizontalOffsetMap.get(targetElement.id) || 0;

                const foreignObject = svgDoc.createElementNS("http://www.w3.org/2000/svg", "foreignObject");

                // Calculando a posi√ß√£o X: √† esquerda do elemento + indenta√ß√£o de 2 espa√ßos
                // 'bbox.x' √© a borda esquerda do elemento.
                // Definimos uma indenta√ß√£o de 2 espa√ßos (ex: 10 pixels).
                const indentation = 10; // Ajuste este valor para a indenta√ß√£o desejada
                const x = bbox.x + indentation + currentHorizontalOffset;

                // Calculando a posi√ß√£o Y: abaixo do elemento + deslocamento vertical acumulado
                // 'bbox.y + bbox.height' nos d√° a borda inferior do elemento.
                // Adicione o 'currentVerticalOffset' para empilhar os links.
                const verticalSpacing = 5; // Espa√ßamento entre o elemento e o primeiro link, e entre links
                const y = bbox.y + bbox.height + verticalSpacing + currentVerticalOffset;

                // Definir uma largura e altura que acomodem o texto do link
                const foWidth = 400; // Largura suficiente para o texto do link
                const foHeight = 15; // Altura para cada linha de link

                foreignObject.setAttribute('x', x);
                foreignObject.setAttribute('y', y);
                foreignObject.setAttribute('width', foWidth);
                foreignObject.setAttribute('height', foHeight);
                foreignObject.style.overflow = 'visible';

                const divContainer = document.createElement('div');
                divContainer.setAttribute('xmlns', 'http://www.w3.org/1999/xhtml');
                divContainer.style.width = '100%';
                divContainer.style.height = '100%';
                divContainer.style.display = 'flex';
                divContainer.style.alignItems = 'center'; // Centraliza verticalmente o texto dentro do fo
                divContainer.style.justifyContent = 'flex-start'; // Alinha o texto √† esquerda dentro do fo
                // Remova o text-align: center do .link-span no CSS se estiver presente

                const span = document.createElement('span');
                span.textContent = link.label;
                span.title = link.description;
                span.className = 'link-span';
                span.addEventListener('click', () => {
                    window.open(link.url, '_blank');
                });

                divContainer.appendChild(span);
                foreignObject.appendChild(divContainer);

                svgDoc.documentElement.appendChild(foreignObject);

                // Atualize o deslocamento vertical para o pr√≥ximo link deste elemento
                // Some a altura do foreignObject (foHeight) mais uma pequena margem para o pr√≥ximo link
                verticalOffsetMap.set(targetElement.id, currentVerticalOffset + foHeight + verticalSpacing); 
                // Se voc√™ quiser que links para o mesmo elemento se alinhem horizontalmente tamb√©m, voc√™ precisaria de um mecanismo mais complexo
                // para calcular a largura de cada link e ajustar o 'x' para cada um, ou simplesmente empilh√°-los verticalmente como agora.

                // Adiciona efeitos hover ao pr√≥prio elemento SVG
                targetElement.classList.add('interactive-node');
                targetElement.addEventListener('mouseenter', () => {
                    targetElement.classList.add('interactive-node-hover');
                });
                targetElement.addEventListener('mouseleave', () => {
                    targetElement.classList.remove('interactive-node-hover');
                });

            } else {
                console.warn(`Elemento com ID "${link.path}" n√£o encontrado no SVG para o link "${link.label}".`);
            }
        });
    }

    document.addEventListener('DOMContentLoaded', () => assignIdsAndLinksToSvgElements());
</script>
</body>
</html>